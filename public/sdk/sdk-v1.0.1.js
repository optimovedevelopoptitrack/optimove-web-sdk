"use strict";var optimoveSDK=function(){var t,e,i=null,o=function(){var t={info:1,error:2,none:3},e="none";return{setLevel:function(t){e=t},log:function(i,o){t[i]>=t[e]&&console.log(o)}}}(),r=function(e){(t=optimoveTenantConfiguration).enableOptitrack?d.initializeOptiTrack(o,t,e):e(!0),t.enableGDN},a=function(t,e){var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,e())}:i.onload=function(){e()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)},n=function(e,i){var r={};if(!t.events[e])return o.log("info","event:"+e+" does node exsits"),!1;r.userId=null,r.visitorData=null,r.eventName=e,r.eventMetadata=t.events[e],r.parameters={};var a=t.events[e];for(var n in a.parameters){var s=a.parameters[n];if(0==s.optional&&void 0==i[n])return o.log("info","required paramMetadata '"+n+"' is missing"),!1;if(void 0!=i[n]){if("String"==s.type&&"string"!=typeof i[n])return o.log("info","parameter '"+n+"' should be type of String"),!1;if("Number"==s.type&&"number"!=typeof i[n])return o.log("info","parameter '"+n+"' should be type of number"),!1;if("Boolean"==s.type&&"boolean"!=typeof i[n])return o.log("info","parameter '"+n+"' should be type of boolean"),!1}r.parameters[n]={value:i[n],metadata:s}}return r},s=function(t){Object.getOwnPropertyNames(t).forEach(function(e){var i=t[e];if("string"==typeof i){var o=i.trim();o=o.toLowerCase(),t[e]=o}})},l=function(){var t=d.getOptitrackVisitorInfo(),e=new Object;return void 0!=t?(e.visitorId=t[1],e.visitCount=t[3]):(o.log("error","in getVisitorsInfoObj Optitrack"),e=void 0),e},c=function(e){if(o.log("info","in reportEvent Real time"),t.enableOptitrack&&t.enableVisitors)e.visitorData=l();else if(!i)return o.log("info","parameter userId is required, please call setUserId method"),!1;u.reportEvent(e)},u=function(){var e,r=function(t){var e="";for(var i in t){var o=t[i]?t[i]:"";t[i]instanceof Array&&(o=encodeURIComponent(JSON.stringify(o))),""!=e&&(e+="&"),e+=i+"="+encodeURIComponent(o)}return e},a=function(t){t&&(t.target==document.getElementById("optiRealPopupDimmer")&&(document.body.removeChild(e),document.removeEventListener("mousedown",a)),"optiRealclosePopupImage"==t.target.id&&(document.body.removeChild(e),document.removeEventListener("mousedown",a)))},n=function(i){try{if(i.IsSuccess&&""!=i.Data){var r=document.createElement("div"),n="";n="<div id='optiRealPopupDimmer' style='position: fixed;bottom: 0;right: 0;top: 0;left: 0;overflow: hidden;display: none; z-index:999999999;background: #000000;opacity : "+(t.realtimeMetaData.showDimmer?.5:0)+";display:block;width: auto;height: auto;'></div>",document.addEventListener("mousedown",a);n+="<div style='max-height:90%;max-width:90%;top: 50%;left: 50%;transform:translate(-50%, -50%);position: fixed;z-index:9999999999;'><div style=' clear:both;min-width: 100px;min-height: 100px;background-color:white; text-align:center;box-shadow:0 0 5px 0 rgba(0, 0, 0, 0.2);'><div style='position:absolute;right:-13px;top:-13px;cursor:pointer;z-index:99999999999; color:white' onclick='OptiRealApi.closePopup();'><img id='optiRealclosePopupImage' src='https://d3qycynbsy5rsn.cloudfront.net/banner_pop_x.png' /></div><div style='border-style: solid;border-width: 5px;border-radius:5px; border-color:white;' >"+i.Data+"</div></div>"+(t.realtimeMetaData.showDimmer&&t.realtimeMetaData.showWatermark?"<div style='position: absolute;z-index:9999999999; clear:both;font-family : Arial;font-size : 9px;color : #CCCCCC;padding-top:6px;margin-left: 5px;'>Powered by Optimove</div>":"")+"</div>",r.innerHTML=n,e=r,document.body.appendChild(r)}}catch(t){o.log("error","Error while executing popup")}},s=function(e,i,a){var s=r(i),l=new XMLHttpRequest,c=t.realtimeMetaData.realtimeGateway.lastIndexOf("/")==t.realtimeMetaData.realtimeGateway.length-1?t.realtimeMetaData.realtimeGateway+e:t.realtimeMetaData.realtimeGateway+"/"+e;l.open("POST",c,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),l.onreadystatechange=function(){try{if(l.readyState==XMLHttpRequest.DONE&&200==l.status){var e=JSON.parse(this.responseText);t.realtimeMetaData.popupCallBack?t.realtimeMetaData.popupCallBack(response):n(e)}}catch(t){o.log("error",t)}},l.send(s)};return{reportEvent:function(e){var o={};for(var r in e.parameters)o[r]=e.parameters[r].value;s("reportEvent",{tid:t.realtimeMetaData.realtimeToken,cid:i,eid:e.eventMetadata.id,visitorId:e.visitorData?e.visitorData.visitorId:null,visitCount:e.visitorData?e.visitorData.visitCount:null,context:JSON.stringify(o)})}}}(),d=function(){var t=null,e=null,i=null,r=null,a=null,n=null,s=null,l=0,c="LogEvent",u=function(t,e,i){if(void 0==i)return!1;try{N();var r=0,s=n.events[e],l=Object.getOwnPropertyNames(s.parameters);l.length;if(l.forEach(function(t){var e=s.parameters[t];if(void 0!=i[t]&&e.optiTrackDimensionId>0){var o=i[t];"Boolean"==e.type&&(o=1==o?1:0),void 0!=o&&(r++,a.setCustomDimension(e.optiTrackDimensionId,o))}}),void 0!==a){var u=s.id,d=e;return a.setCustomDimension(n.optitrackMetaData.eventIdCustomDimensionId,u),a.setCustomDimension(n.optitrackMetaData.eventNameCustomDimensionId,d),a.trackEvent(c,e),!0}throw"OptiTrackModule:_tracker is undefined !!"}catch(t){var p="OptiTrackModule:logOptitrackCustomEvent Failed!!, error =  "+t;o.log(p)}},d=function(t,e,i,o){try{var r=C(e);if(b(t),1==n.isSPASite&&++l>1&&a.setGenerationTimeMs(0),0==r)throw"customURL-"+e+"is not a valid URL";a.enableLinkTracking(!0),a.setCustomUrl(e),void 0!==i&&null!=i?a.trackPageView(i):a.trackPageView(),void 0!==o&&v(t,o),1==n.optitrackMetaData.sendUserAgentHeader&&f(t),1==n.supportUserEmailStitch&&p(t,e)}catch(t){var c="OptiTrackModule:logOptitrackPageVisit Failed!!, error =  "+t;s.log("error",c)}},p=function(t,e){var i={},o=null,r=null,l=null;try{var u=D("stitch_event");null!=u&&(o=y(u,"sourcePublicCustomerId"),r=y(u,"sourceVisitorId"),l=y(u,"targetVsitorId"));var d=m(e);if(0==d.OptimoveStitchDataExist){var p=window.location.pathname,v=m(p);1==v.OptimoveStitchDataExist&&(i=v,!0)}else i=d,!0;if(1==i&&void 0!==a){N();var f=0;a.getVisitorId();null!=i.OptimovePublicCustomerId?o.optiTrackDimensionId>0&&(f++,a.setCustomDimension(o.optiTrackDimensionId,i.OptimovePublicCustomerId)):r.optiTrackDimensionId>0&&(f++,a.setCustomDimension(r.optiTrackDimensionId,i.OptimovePublicCustomerId)),l.optiTrackDimensionId>0&&(f++,a.setCustomDimension(l.optiTrackDimensionId,i.OptimovePublicCustomerId));var g=u.id;a.setCustomDimension(n.optitrackMetaData.eventIdCustomDimensionId,g),a.setCustomDimension(n.optitrackMetaData.eventNameCustomDimensionId,"stitch_event"),a.trackEvent(c,"stitch_event")}}catch(t){var h="OptiTrackModule:processEmailStitch Failed!!, error =  "+t;s.log("error",h)}},m=function(t){var e={};e.OptimoveStitchDataExist=!1;var i=!1;try{var o=t.split("&");o.length>0&&o.forEach(function(t,o){if(1==(i=t.search("OptimoveStitchFlow")>-1&&"true"==t.slice("OptimoveStitchFlow".length+1))){if(t.search("OptimovePublicCustomerId")>-1){var r=t.slice("OptimovePublicCustomerId".length+1);e.OptimovePublicCustomerId=r}if(t.search("optimoveVisitorId")>-1){var a=t.slice("optimoveVisitorId".length+1);e.optimoveVisitorId=a}e.OptimoveStitchDataExist=!0}})}catch(t){var r="OptiTrackModule:getOptimoveStitchData Failed!!, error =  "+t;s.log("error",r)}return e},v=function(t,e){u(t,"page_category_event",{category:e})},f=function(t){try{if(null!=M(t,"11602c8b76fe7626ca586081b94892e4"))return void s.log("info","User-Agent Header Already triggered");"undefined"!=typeof navigator&&void 0!==navigator.userAgent&&(u(t,"user_agent_header_event",{user_agent_header:navigator.userAgent}),O(t,"11602c8b76fe7626ca586081b94892e4",!0))}catch(t){var e="OptiTrackModule:logUserAgentHeaderEvent Failed!!, error =  "+t;s.log("error",e)}},g=function(t,e){try{if(0==S(e))throw"email "+e+" is not valid";u(t,"Set_email_event",{email:e})}catch(t){var i="OptiTrackModule:logOptitrackUserEmail Failed!!, error =  "+t;s.log("error",i)}},h=function(e,i){var o=I(i);try{if(1==o&&null==t&&(w(e,i),void 0!==a&&a.getUserId()!=i)){var r=a.getVisitorId();a.setUserId(i),t=i;var n=a.getVisitorId();k(e,r,i,n)}}catch(t){var l="OptiTrackModule:setOptitrackUserId Failed!!, error = "+t;s.log("error",l)}},k=function(t,e,i,o){try{var r=D("set_user_id_event");if(null!=r){N();var l=y(r,"originalVisitorId"),u=y(r,"updatedVisitorId"),d=y(r,"userId"),p=r.id;a.setCustomDimension(n.optitrackMetaData.eventIdCustomDimensionId,p),a.setCustomDimension(n.optitrackMetaData.eventNameCustomDimensionId,"set_user_id_event"),void 0!=d&&a.setCustomDimension(d.optiTrackDimensionId,i),void 0!=l&&a.setCustomDimension(l.optiTrackDimensionId,e),void 0!=u&&a.setCustomDimension(u.optiTrackDimensionId,o),a.trackEvent(c,"set_user_id_event")}}catch(t){var m="OptiTrackModule:logSetUserIdEvent Failed!!, error =  "+t;s.log("error",m)}},D=function(t){var e=n.events[t];return void 0==e?null:e},y=function(t,e){var i=t.parameters[e];return void 0==i?null:i},I=function(t){return void 0!==t&&"string"==typeof t&&void 0!=t&&""!=t&&"null"!=t&&!t.includes("undefine")},C=function(t){return/(https?|http?|ftp):\/\/[^\s\/$.?#].[^\s]*$/.test(t)},b=function(e){return null==t&&(e._userId=E(e),void 0!==a&&null!=e._userId)&&(a.setUserId(e._userId),!0)},O=function(t,e,i){try{if(1==n.optitrackMetaData.useSessionStorage){var o=sessionStorage.getItem(e);null!=o&&o==i||sessionStorage.setItem(e,i)}else s.log("info","Optitrack: persistSDKSessionData()  Not  Persisted")}catch(t){var r="OptiTrackModule: persistSDKSessionData ()  Failed error = "+t;s.log("error",r)}},M=function(t,e){try{if(1!=n.optitrackMetaData.useSessionStorage)return s.log("info","Optitrack: persistSDKSessionData()  key:"+e+" Not Persisted"),null;var i=sessionStorage.getItem(e);if(null!=i)return{key:e,value:i}}catch(t){var o="OptiTrackModule: getPersistedSDKSessionData ()  Failed error = "+t;return s.log("error",o),null}},w=function(t,e){O(t,"215d26f4be2047f348066e44ee7fe3d6",e)},E=function(t){var e=M(t,"215d26f4be2047f348066e44ee7fe3d6");if(null!=e)return e.value},S=function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},T=function(t,e,i){if(null!=e){var o=document,r=o.createElement("script"),a=o.getElementsByTagName("script")[0];r.type="text/javascript",r.async=!0,r.defer=!0,r.src=e,r.onload=function(){x(t,i)},a.parentNode.insertBefore(r,a)}},x=function(t,e){a=_(),P(t,a,e)},P=function(t,e,i){i(null==e?!1:!0)},_=function(){return void 0!==self.Piwik?self.Piwik.getAsyncTracker(e+"piwik.php",i):void 0},V=function(t){return t.optitrackMetaData.optitrackEndpoint},U=function(t){return t.optitrackMetaData.siteId},R=function(t){return V(t)+"piwik.js"},N=function(){var t=n.optitrackMetaData.actionCustomDimensionsStartId,e=n.optitrackMetaData.actionCustomDimensionsStartId+n.optitrackMetaData.maxActionCustomDimensions;for(t=n.optitrackMetaData.actionCustomDimensionsStartId;t<=e;t++)a.deleteCustomDimension(t)};return{initializeOptiTrack:function(t,o,a){s=t,c=(n=o).optitrackMetaData.eventCategoryName,e=V(o),i=U(o),r=R(o);T(this,r,a)},logPageVisitEvent:function(t,e,i){d(this,t,e,i)},setUserId:function(t){h(this,t)},logUserEmail:function(t){g(this,t)},logEvent:function(t,e){u(this,t,e)},getOptitrackVisitorInfo:function(t){var e=[];try{if(void 0===a)throw"tracker is not defined";e=a.getVisitorInfo()}catch(t){var i="OptiTrackModule: getOptitrackVisitorInfo "+t;s.log("error",i)}return e},getUserId:E}}(),p={updateCookieMatcher:function(e){(function(t){var e="https://gcm.optimove.events/setCookie?optimove_id="+t,i=document.createElement("img");i.style.display="none",i.setAttribute("src",e),document.body.appendChild(i)})(void 0!==e&&null!=e?e:l().visitorId),function(t,e){var i="https://cm.g.doubleclick.net/pixel?google_nid="+e+"&google_cm&tenant_id="+t,o=document.createElement("img");o.style.display="none",o.setAttribute("src",i),document.body.appendChild(o)}(t.cookieMatcherMetaData.tenantToken,t.cookieMatcherMetaData.optimoveCookieMatcherId)}};return{initialize:function(t,e,i,n){n&&o.setLevel(n),a("http://sdk-cdn.optimove.net/webconfig/"+t+"/"+e+".js",function(){o.log("info","configuration loaded successfully"),r(i)})},API:{getVersion:function(){return"1.0.1"},getConfigurationVersion:function(){return t.version},reportEvent:function(e,i){try{var r=n(e,i);if(r){if(s(i),t.enableOptitrack)try{o.log("info","in reportEvent Optitrack"),d.logEvent(e,i)}catch(t){o.log("error",t)}t.enableRealtime&&r.eventMetadata.supportedOnRealTime&&c(r)}}catch(t){o.log("error",t)}},setRealTimeOptions:function(e){null!=e.showDimmer&&(t.realtimeMetaData.showDimmer=e.showDimmer),null!=e.showWatermark&&(t.realtimeMetaData.showWatermark=e.showWatermark),null!=e.reportEventCallback&&(t.realtimeMetaData.popupCallBack=reportEventCallback)},setUserId:function(e){i=e.trim(),t.enableOptitrack&&(o.log("info","call setUserId Optitrack"),d.setUserId(i)),1==t.supportCookieMatcher&&p.updateCookieMatcher(i)},setUserEmail:function(i){if(e=i.trim(),t.enableOptitrack)try{o.log("info","call setUserEmail Optitrack"),d.logUserEmail(e)}catch(t){o.log("error",t)}if(t.enableRealtime){var r=n("Set_email_event",{email:e});c(r)}},setPageVisit:function(e,i,r){var a=e.trim(),s=i.trim(),l=r.trim();if(t.enableOptitrack&&(o.log("info","call setPageVisit Optitrack"),d.logPageVisitEvent(a,s,l)),1==t.supportCookieMatcher&&p.updateCookieMatcher(null),t.enableRealtime){o.log("info","call setPageVisit Realtime");var u=n("PageVisit",{customURL:a,pageTitle:s,category:l});c(u)}}}}}();